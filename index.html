<template>
  <div class="lesson-list">
    <div class="header">
      <h1>Lessons</h1>
      <button
        :disabled="cart.length === 0"
        @click="toggleCart"
        class="cart-btn"
      >
        {{ showCart ? 'Back to Lessons' : 'Shopping Cart' }} ({{ cart.length }})
      </button>
    </div>
    <div class="sort-controls">
      <label for="sortAttr">Sort by:</label>
      <select v-model="sortAttribute" id="sortAttr">
        <option value="subject">Subject</option>
        <option value="location">Location</option>
        <option value="price">Price</option>
        <option value="spaces">Spaces</option>
      </select>
      <label for="sortOrder">Order:</label>
      <select v-model="sortOrder" id="sortOrder">
        <option value="asc">Ascending</option>
        <option value="desc">Descending</option>
      </select>
    </div>
    <div v-if="!showCart">
      <ul>
        <li v-for="lesson in sortedLessons" :key="lesson.id" class="lesson-item">
        <img :src="lesson.icon" alt="Lesson Icon" class="lesson-icon" />
        <div class="lesson-details">
          <div><strong>Subject:</strong> {{ lesson.subject }}</div>
          <div><strong>Location:</strong> {{ lesson.location }}</div>
          <div><strong>Price:</strong> ${{ lesson.price }}</div>
          <div><strong>Spaces:</strong> {{ lesson.spaces }}</div>
          <button
            :disabled="lesson.spaces === 0"
            @click="addToCart(lesson)"
            class="add-to-cart"
          >
            Add to Cart
          </button>
        </div>
        </li>
      </ul>
    </div>
    <div v-else>
      <h2>Shopping Cart</h2>
      <ul>
        <li v-for="lesson in cart" :key="lesson.id" class="lesson-item">
          <img :src="lesson.icon" alt="Lesson Icon" class="lesson-icon" />
          <div class="lesson-details">
            <div><strong>Subject:</strong> {{ lesson.subject }}</div>
            <div><strong>Location:</strong> {{ lesson.location }}</div>
            <div><strong>Price:</strong> ${{ lesson.price }}</div>
            <button @click="removeFromCart(lesson)">Remove</button>
          </div>
        </li>
      </ul>
    </div>
    </div>
  </div>
</template>

<script>
export default {
  name: 'LessonList',
  data() {
    return {
      sortAttribute: 'subject',
      sortOrder: 'asc',
      showCart: false,
      cart: [],
      lessons: [
        { id: 1, subject: 'Math', location: 'Room 101', price: 20, spaces: 5, icon: 'https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/svgs/solid/calculator.svg' },
        { id: 2, subject: 'English', location: 'Room 102', price: 18, spaces: 5, icon: 'https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/svgs/solid/book.svg' },
        { id: 3, subject: 'Physics', location: 'Lab 1', price: 25, spaces: 5, icon: 'https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/svgs/solid/atom.svg' },
        { id: 4, subject: 'Chemistry', location: 'Lab 2', price: 22, spaces: 5, icon: 'https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/svgs/solid/flask.svg' },
        { id: 5, subject: 'Biology', location: 'Room 103', price: 21, spaces: 5, icon: 'https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/svgs/solid/leaf.svg' },
        { id: 6, subject: 'History', location: 'Room 104', price: 19, spaces: 5, icon: 'https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/svgs/solid/landmark.svg' },
        { id: 7, subject: 'Geography', location: 'Room 105', price: 20, spaces: 5, icon: 'https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/svgs/solid/globe.svg' },
        { id: 8, subject: 'Music', location: 'Music Room', price: 23, spaces: 5, icon: 'https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/svgs/solid/music.svg' },
        { id: 9, subject: 'Art', location: 'Art Studio', price: 24, spaces: 5, icon: 'https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/svgs/solid/palette.svg' },
        { id: 10, subject: 'Computer Science', location: 'Lab 3', price: 26, spaces: 5, icon: 'https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/svgs/solid/laptop-code.svg' }
      ]
    }
  },
  methods: {
    addToCart(lesson) {
      if (lesson.spaces > 0) {
        lesson.spaces--;
        this.cart.push(lesson);
      }
    },
    removeFromCart(lesson) {
      const idx = this.cart.findIndex(l => l.id === lesson.id);
      if (idx !== -1) {
        this.cart.splice(idx, 1);
        lesson.spaces++;
      }
    },
    toggleCart() {
      this.showCart = !this.showCart;
    }
  },
  computed: {
    sortedLessons() {
      const sorted = [...this.lessons].sort((a, b) => {
        let valA = a[this.sortAttribute];
        let valB = b[this.sortAttribute];
        if (typeof valA === 'string') {
          valA = valA.toLowerCase();
          valB = valB.toLowerCase();
        }
        if (valA < valB) return this.sortOrder === 'asc' ? -1 : 1;
        if (valA > valB) return this.sortOrder === 'asc' ? 1 : -1;
        return 0;
      });
      return sorted;
    }
  }
}
</script>

<style scoped>
.lesson-list {
  max-width: 600px;
  margin: 0 auto;
}
.lesson-item {
  display: flex;
  align-items: center;
  margin-bottom: 1rem;
  padding: 0.5rem;
  border: 1px solid #ccc;
  border-radius: 8px;
}
.lesson-icon {
  width: 40px;
  height: 40px;
  margin-right: 1rem;
}
.lesson-details > div {
  margin-bottom: 0.25rem;
}
</style>
